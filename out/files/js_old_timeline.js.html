<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>js/old/timeline.js</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/3.9.1/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="icon" href="../assets/favicon.ico">
    <script src="http://yui.yahooapis.com/combo?3.9.1/build/yui/yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
                <h1><img src="../assets/css/logo.png" title="" width="117" height="52"></h1>
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: </em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
                    <h2 class="off-left">APIs</h2>
                    <div id="api-tabview" class="tabview">
                        <ul class="tabs">
                            <li><a href="#api-classes">Classes</a></li>
                            <li><a href="#api-modules">Modules</a></li>
                        </ul>
                
                        <div id="api-tabview-filter">
                            <input type="search" id="api-filter" placeholder="Type to filter APIs">
                        </div>
                
                        <div id="api-tabview-panel">
                            <ul id="api-classes" class="apis classes">
                            </ul>
                
                            <ul id="api-modules" class="apis modules">
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
                    Show:
                    <label for="api-show-inherited">
                        <input type="checkbox" id="api-show-inherited" checked>
                        Inherited
                    </label>
            
                    <label for="api-show-protected">
                        <input type="checkbox" id="api-show-protected">
                        Protected
                    </label>
            
                    <label for="api-show-private">
                        <input type="checkbox" id="api-show-private">
                        Private
                    </label>
                    <label for="api-show-deprecated">
                        <input type="checkbox" id="api-show-deprecated">
                        Deprecated
                    </label>
            
                </div>
            
            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
<h1 class="file-heading">File: js/old/timeline.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">
function D3_Timeline(){}

/** 
 * Fonction show : appelle la fonction load en lui passant le tsv
 *
 * @param data : les donnees
 */
D3_Timeline.prototype.show = function(data, configs) {
	// data is file path
	if(typeof data === &quot;string&quot;){
		d3.tsv(data, function(error, dataTsv) {
			if (error) alert(error);
			D3_Timeline.load(dataTsv, configs);
		});
	}
	// data is tsv
	else {
		D3_Timeline.load(data, configs);
	}
}


/** 
 * Fonction load : ajoute les balises svg au conteneur pour afficher la vue
 *
 * @param tsv : fichier tsv 
 */
D3_Timeline.load = function(data, configs) {
	/**
	 * Definition des variables generiques
	 */
	//Format de la date
	var dateFormat = configs.dateFormat;
	
	//L&#x27;element qui contient la visualisation
	var container = configs.container;
	
	//On cree un nouveau noeud &lt;svg&gt;
	var svg = d3.select(container).append(&quot;svg&quot;).attr(&quot;id&quot;, &quot;graph&quot;);

	var margin = 60, 
		width = parseInt(d3.select(&quot;#graph&quot;).style(&quot;width&quot;)) - margin * 2, 
		height = parseInt(d3.select(&quot;#graph&quot;).style(&quot;height&quot;)) - margin * 2;
	
	/*var margin = 60;
	var myChart = chart().height(parseInt(d3.select(&quot;#graph&quot;).style(&quot;height&quot;)) - margin * 2)
	.width(parseInt(d3.select(&quot;#graph&quot;).style(&quot;width&quot;)) - margin * 2);
	
	var width = myChart.width;
	var height = myChart.height;
	console.log(width);*/

	var parseDate = d3.time.format(dateFormat).parse;

	var x = d3.time.scale()
				.range([ 0, width ])
				.nice(d3.time.year);

	var y = d3.scale.linear()
				.range([ height, 0 ])
				.nice();

	var xAxis = d3.svg.axis().scale(x).orient(&quot;bottom&quot;);

	var yAxis = d3.svg.axis().scale(y).orient(&quot;left&quot;);

	var line = d3.svg.line()
					.x(function(d) {
						return x(d.date);
					})
					.y(function(d) {
						return y(d.close);
					});

	var graph = d3.select(&quot;#graph&quot;)
					.attr(&quot;width&quot;, width + margin * 2)
					.attr(&quot;height&quot;, height + margin * 2)
					.append(&quot;g&quot;)
					.attr(&quot;transform&quot;, &quot;translate(&quot; + margin + &quot;,&quot; + margin + &quot;)&quot;);

	data.forEach(function(d) {
		d.date = parseDate(d.date);
		d.close = +d.close;
	});

	x.domain(d3.extent(data, function(d) {
		return d.date;
	}));
	
	y.domain([ 0, d3.max(data, function(d) {
		return d.close;
	}) ]);

	graph.append(&quot;g&quot;)
			.attr(&quot;class&quot;, &quot;x axis&quot;)
			.attr(&quot;transform&quot;, &quot;translate(0,&quot; + height + &quot;)&quot;)
			.call(xAxis);

	graph.append(&quot;g&quot;)
			.attr(&quot;class&quot;, &quot;y axis&quot;)
			.call(yAxis)
			.append(&quot;text&quot;)
			.attr(&quot;transform&quot;, &quot;rotate(-90)&quot;)
			.attr(&quot;y&quot;, 6)
			.attr(&quot;dy&quot;, &quot;.71em&quot;)
			.style(&quot;text-anchor&quot;, &quot;end&quot;);
	
	dataPerPixel = data.length / width;
	dataResampled = data.filter(function(d, i) {
		return i % Math.ceil(dataPerPixel) == 0;
	});

	graph.append(&quot;path&quot;)
			.datum(dataResampled)
			.attr(&quot;class&quot;, &quot;line&quot;)
			.attr(&quot;d&quot;, line);

	var firstRecord = data[data.length - 1], lastRecord = data[0];

	var first = graph.append(&quot;g&quot;)
						.attr(&quot;class&quot;, &quot;first&quot;)
						.style(&quot;display&quot;, &quot;none&quot;);

	first.append(&quot;text&quot;)
			.attr(&quot;x&quot;, -8)
			.attr(&quot;y&quot;, 4)
			.attr(&quot;text-anchor&quot;, &quot;end&quot;)
			.text(firstRecord.close);
	first.append(&quot;circle&quot;).attr(&quot;r&quot;, 4);

	var last = graph.append(&quot;g&quot;)
						.attr(&quot;class&quot;, &quot;last&quot;)
						.style(&quot;display&quot;, &quot;none&quot;);

	last.append(&quot;text&quot;)
			.attr(&quot;x&quot;, 8)
			.attr(&quot;y&quot;, 4)
			.text(lastRecord.close);
	last.append(&quot;circle&quot;)
			.attr(&quot;r&quot;, 4);

	function resize() {

		var width = parseInt(d3.select(&quot;#graph&quot;)
									.style(&quot;width&quot;)) - margin * 2, 
			height = parseInt(d3.select(&quot;#graph&quot;)
									.style(&quot;height&quot;)) - margin * 2;

		x.range([ 0, width ]);
		y.range([ height, 0 ]);

		if (width &lt; 300 &amp;&amp; height &lt; 80) {
			graph.select(&#x27;.x.axis&#x27;).style(&quot;display&quot;, &quot;none&quot;);
			graph.select(&#x27;.y.axis&#x27;).style(&quot;display&quot;, &quot;none&quot;);

			graph.select(&quot;.first&quot;)
					.attr(&quot;transform&quot;, &quot;translate(&quot; + x(firstRecord.date) + &quot;,&quot; + y(firstRecord.close) + &quot;)&quot;)
					.style(&quot;display&quot;, &quot;initial&quot;);

			graph.select(&quot;.last&quot;)
					.attr(&quot;transform&quot;,&quot;translate(&quot; + x(lastRecord.date) + &quot;,&quot;+ y(lastRecord.close) + &quot;)&quot;)
					.style(&quot;display&quot;, &quot;initial&quot;);
		} else {
			graph.select(&#x27;.x.axis&#x27;).style(&quot;display&quot;, &quot;initial&quot;);
			graph.select(&#x27;.y.axis&#x27;).style(&quot;display&quot;, &quot;initial&quot;);
			graph.select(&quot;.last&quot;).style(&quot;display&quot;, &quot;none&quot;);
			graph.select(&quot;.first&quot;).style(&quot;display&quot;, &quot;none&quot;);
		}

		yAxis.ticks(Math.max(height / 50, 2));
		xAxis.ticks(Math.max(width / 100, 2));

		graph.attr(&quot;width&quot;, width + margin * 2)
				.attr(&quot;height&quot;,height + margin * 2)

		graph.select(&#x27;.x.axis&#x27;)
				.attr(&quot;transform&quot;, &quot;translate(0,&quot; + height + &quot;)&quot;)
				.call(xAxis);

		graph.select(&#x27;.y.axis&#x27;)
				.call(yAxis);

		dataPerPixel = data.length / width;
		dataResampled = data.filter(function(d, i) {
			return i % Math.ceil(dataPerPixel) == 0;
		});

		graph.selectAll(&#x27;.line&#x27;).datum(dataResampled).attr(&quot;d&quot;, line);
	}

	d3.select(window).on(&#x27;resize&#x27;, resize);
	resize();
}
    </pre>
</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/../api.js"></script>
<script src="../assets/js/api-filter.js"></script>
<script src="../assets/js/api-list.js"></script>
<script src="../assets/js/api-search.js"></script>
<script src="../assets/js/apidocs.js"></script>
</body>
</html>
